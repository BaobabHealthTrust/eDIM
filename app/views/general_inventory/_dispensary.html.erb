<div id="packSize" class="modal">
  <!-- Modal content -->
  <div class="modal-content" style="width: 40vw !important;">
    <div style="display: table;">
      <div style="display: table-row;">
        <div style="display: table-cell;background-color:#eeeeee;width:40vw;padding: 10px;">
          <input type="number" id="packQty" placeholder="Enter Pack Size" style="font-size: 2em; width: 90%;line-height: 3em;">
          <span class="close" onmousedown="hideModal('packSize');">&times;</span>
        </div>
      </div>
      <div style="display: table-row;">
        <div style="display: table-cell; border: 1px inset black;">
          <div style="margin-top: 5px;">
            <table width="100%" cellspacing="20" >
              <tr>
                <td class="customButton" onmousedown="append(1);"><span>1</span></td>
                <td class="customButton" onmousedown="append(2);"><span>2</span></td>
                <td class="customButton" onmousedown="append(3);"><span>3</span></td>
              </tr>
              <tr>
                <td class="customButton" onmousedown="append(4);"><span>4</span></td>
                <td class="customButton" onmousedown="append(5);"><span>5</span></td>
                <td class="customButton" onmousedown="append(6);"><span>6</span></td>
              </tr>
              <tr>
                <td class="customButton" onmousedown="append(7);"><span>7</span></td>
                <td class="customButton" onmousedown="append(8);"><span>8</span></td>
                <td class="customButton" onmousedown="append(9);"><span>9</span></td>
              </tr>
              <tr>
                <td class="customButton" onmousedown="append(0);"><span>0</span></td>
                <td class="customButton" onmousedown="append('del');"><span>del</span></td>
                <td class="customButton" style="background-color: #00bf6f !important;" onmousedown="customPrePack();"><span>Pack</span></td>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div style="height: 78vh; width: 100%">
  <div style="display: table-row">
    <div style="display: table-cell;width: 30vw;height:74vh;">
      <div style="width: 100%; background-color: #006495;height: 4vh;text-align: center;color: white;padding-top: 1vh;">
        <span style="font-size: 1.5em;font-family: 'Arial Black', Gadget, sans-serif;">Summary</span>
      </div>
      <div style="width: 100%; background-color: #C0C0C0;text-align: center;">
        <br/>
        <h2>Amount Received</h2>
        <span style="font-size: 2em; color: darkred;"><%= @item.received_quantity %></span>
        <h2>Amount Remaining</h2>
        <span style="font-size: 2em; color: darkred;"><%= @item.current_quantity %></span>
        <h2>Amount Used</h2>
        <span style="font-size: 2em; color: darkred;"><%= @item.received_quantity - @item.current_quantity %></span>
        <h2>Days to Expiry</h2>
        <span style="font-size: 2em; color: darkred;"><%= (@item.expiration_date - Date.current).to_i %> Days</span>
        <br/><br/>
      </div>
    </div>
    <div style="display: table-cell;width: 70vw;height:74vh;">
      <div style="width: 100%; background-color: #006495;height: 4vh;text-align: center;color: white;padding-top: 1vh;">
        <span style="font-size: 1.5em;font-family: 'Arial Black', Gadget, sans-serif;">Pre-packing</span>
      </div>
      <div style="display: table-row; padding-top: 1vh">
        <div class="on-screen">
          <div onmousedown="prepack(6)" class="bttn bttn-primary bttn-lg gradient" type="button">
            Pack of 6
          </div>
        </div>
        <div class="on-screen">
          <div onmousedown="prepack(10)" class="bttn bttn-primary bttn-lg gradient" type="button">
            Pack of 10
          </div>
        </div>
        <div class="on-screen">
          <div onmousedown="prepack(12)" class="bttn bttn-primary bttn-lg gradient" type="button">
            Pack of 12
          </div>
        </div>
        <div class="on-screen">
          <div onmousedown="prepack(15)" class="bttn bttn-primary bttn-lg gradient" type="button">
            Pack of 15
          </div>
        </div>
      </div>
      <div style="display: table-row; padding-top: 1vh">
        <div class="on-screen">
          <div onmousedown="prepack(18)" class="bttn bttn-primary bttn-lg gradient" type="button">
            Pack of 18
          </div>
        </div>
        <div class="on-screen">
          <div onmousedown="prepack(20)" class="bttn bttn-primary bttn-lg gradient" type="button">
            Pack of 20
          </div>
        </div>
        <div class="on-screen">
          <div onmousedown="prepack(30)" class="bttn bttn-primary bttn-lg gradient" type="button">
            Pack of 30
          </div>
        </div>
        <div class="on-screen">
          <div onmousedown="showModal('packSize')" class="bttn bttn-primary bttn-lg gradient" type="button">
            Other
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="footer" >
  <button onmousedown="window.location = '/general_inventory/list?drug_id=<%= @item.drug_id %>'" class="nav-bttn green" style="margin-right: 1vw;float: right;">
    <%= t('forms.buttons.finish')%></button>
</div>

<%= form_for :general_inventory, :url => "/general_inventory/#{@item.id}/pre_packing"  do |f| %>
    <input type="hidden" name="bottle_id" id="bottle_id" value="<%= @item.gn_identifier%>"/>
    <input type="hidden" name="pre_pack_amount" id="pre_pack_amount" value="0"/>
<% end %>

<script type="text/javascript">
  var modal = document.getElementById('packSize');
  // When the user clicks anywhere outside of the modal, close it
  window.onclick = function(event) {
      if (event.target == modal) {
          modal.style.display = "none";
      }
  }
  function prepack(amount) {
      $('#pre_pack_amount')[0].value = amount;
      document.forms[0].submit();
  }

  function append(key){
      var input = document.getElementById("packQty");

      if (key != "del")
      {
          input.value = input.value.toString().trim() + key;

      }
      else
      {
          var temp = parseInt(input.value).toString().trim();
          temp = parseFloat(temp.substring(0,temp.length-1));
          input.value = (temp == "NaN" ? "" : temp);
      }
  }

  function customPrePack()
  {
      var input = document.getElementById("packQty");

      if(parseInt(input.value) > 0)
      {
         prepack(input.value);
      }
      else
      {
          input.focus();
      }
  }
</script>